# environment: deployment environment (dev | staging | prod)
environment: dev

providers:
  # fake-liquid: moderate volatility venue demonstrating instrument refresh and klines
  fake-liquid:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 150ms
      trade_interval: 120ms
      book_snapshot_interval: 400ms
      instrument_refresh_interval: 15m
      kline_interval: 30s
      balance_update_interval: 2s
      price_model:
        drift: 0.00018
        volatility: 0.009
        shock_probability: 0.02
        shock_magnitude: 0.015
      trade_model:
        min_quantity: 0.02
        max_quantity: 1.5
      order_book:
        levels: 14
        max_mutation_width: 6
      venue_behavior:
        latency_min: 8ms
        latency_max: 28ms
        transient_error: 0.0025
        disconnect_chance: 0.0002
        disconnect_for: 2s
  # fake-volatile: fast-moving market with aggressive shocks for stress tests
  fake-volatile:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 80ms
      trade_interval: 60ms
      book_snapshot_interval: 200ms
      kline_interval: 15s
      balance_update_interval: 1500ms
      price_model:
        drift: 0.00035
        volatility: 0.02
        shock_probability: 0.08
        shock_magnitude: 0.05
      trade_model:
        min_quantity: 0.01
        max_quantity: 2.8
      order_book:
        levels: 18
        max_mutation_width: 9
      venue_behavior:
        latency_min: 4ms
        latency_max: 18ms
        transient_error: 0.006
        disconnect_chance: 0.001
        disconnect_for: 1500ms
  # fake-calm: slower venue illustrating tight error budgets and wider latency bands
  fake-calm:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 250ms
      trade_interval: 250ms
      book_snapshot_interval: 1s
      instrument_refresh_interval: 20m
      kline_interval: 1m
      balance_update_interval: 4s
      price_model:
        drift: 0.00005
        volatility: 0.004
        shock_probability: 0.01
        shock_magnitude: 0.01
      trade_model:
        min_quantity: 0.05
        max_quantity: 1.0
      order_book:
        levels: 10
        max_mutation_width: 4
      venue_behavior:
        latency_min: 12ms
        latency_max: 45ms
        transient_error: 0.0015
        disconnect_chance: 0.00005
        disconnect_for: 4s
  fake-ultra-low-latency:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 40ms
      trade_interval: 35ms
      book_snapshot_interval: 120ms
      instrument_refresh_interval: 10m
      kline_interval: 10s
      balance_update_interval: 1s
      price_model:
        drift: 0.00042
        volatility: 0.03
        shock_probability: 0.05
        shock_magnitude: 0.04
      trade_model:
        min_quantity: 0.005
        max_quantity: 1.2
      order_book:
        levels: 22
        max_mutation_width: 5
      venue_behavior:
        latency_min: 2ms
        latency_max: 9ms
        transient_error: 0.004
        disconnect_chance: 0.0003
        disconnect_for: 1s
  fake-night-owl:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 400ms
      trade_interval: 350ms
      book_snapshot_interval: 2s
      instrument_refresh_interval: 25m
      kline_interval: 2m
      balance_update_interval: 5s
      price_model:
        drift: -0.00002
        volatility: 0.003
        shock_probability: 0.004
        shock_magnitude: 0.006
      trade_model:
        min_quantity: 0.08
        max_quantity: 0.9
      order_book:
        levels: 8
        max_mutation_width: 3
      venue_behavior:
        latency_min: 16ms
        latency_max: 65ms
        transient_error: 0.0008
        disconnect_chance: 0.00004
        disconnect_for: 6s
  fake-asia-session:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 110ms
      trade_interval: 85ms
      book_snapshot_interval: 280ms
      instrument_refresh_interval: 12m
      kline_interval: 20s
      balance_update_interval: 1800ms
      price_model:
        drift: 0.00027
        volatility: 0.016
        shock_probability: 0.035
        shock_magnitude: 0.032
      trade_model:
        min_quantity: 0.02
        max_quantity: 2.1
      order_book:
        levels: 16
        max_mutation_width: 7
      venue_behavior:
        latency_min: 6ms
        latency_max: 22ms
        transient_error: 0.003
        disconnect_chance: 0.0006
        disconnect_for: 1200ms
  fake-europe-open:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 140ms
      trade_interval: 95ms
      book_snapshot_interval: 320ms
      instrument_refresh_interval: 11m
      kline_interval: 25s
      balance_update_interval: 1500ms
      price_model:
        drift: 0.00019
        volatility: 0.014
        shock_probability: 0.022
        shock_magnitude: 0.028
      trade_model:
        min_quantity: 0.03
        max_quantity: 1.7
      order_book:
        levels: 15
        max_mutation_width: 6
      venue_behavior:
        latency_min: 7ms
        latency_max: 26ms
        transient_error: 0.0022
        disconnect_chance: 0.0005
        disconnect_for: 1600ms
  fake-deep-liquidity:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 90ms
      trade_interval: 70ms
      book_snapshot_interval: 210ms
      instrument_refresh_interval: 9m
      kline_interval: 18s
      balance_update_interval: 1400ms
      price_model:
        drift: 0.00012
        volatility: 0.008
        shock_probability: 0.017
        shock_magnitude: 0.02
      trade_model:
        min_quantity: 0.015
        max_quantity: 3.4
      order_book:
        levels: 28
        max_mutation_width: 8
      venue_behavior:
        latency_min: 5ms
        latency_max: 20ms
        transient_error: 0.002
        disconnect_chance: 0.00045
        disconnect_for: 2s
  fake-fragile:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 220ms
      trade_interval: 180ms
      book_snapshot_interval: 650ms
      instrument_refresh_interval: 30m
      kline_interval: 45s
      balance_update_interval: 2500ms
      price_model:
        drift: 0.00009
        volatility: 0.012
        shock_probability: 0.05
        shock_magnitude: 0.06
      trade_model:
        min_quantity: 0.03
        max_quantity: 1.2
      order_book:
        levels: 12
        max_mutation_width: 10
      venue_behavior:
        latency_min: 18ms
        latency_max: 85ms
        transient_error: 0.009
        disconnect_chance: 0.0035
        disconnect_for: 5s
  fake-noise-burst:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 95ms
      trade_interval: 60ms
      book_snapshot_interval: 260ms
      instrument_refresh_interval: 14m
      kline_interval: 22s
      balance_update_interval: 1700ms
      price_model:
        drift: 0.00025
        volatility: 0.026
        shock_probability: 0.09
        shock_magnitude: 0.07
      trade_model:
        min_quantity: 0.01
        max_quantity: 2.6
      order_book:
        levels: 19
        max_mutation_width: 11
      venue_behavior:
        latency_min: 9ms
        latency_max: 34ms
        transient_error: 0.0055
        disconnect_chance: 0.0012
        disconnect_for: 1800ms
  fake-swing:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 160ms
      trade_interval: 140ms
      book_snapshot_interval: 480ms
      instrument_refresh_interval: 18m
      kline_interval: 40s
      balance_update_interval: 2100ms
      price_model:
        drift: 0.00031
        volatility: 0.018
        shock_probability: 0.03
        shock_magnitude: 0.045
      trade_model:
        min_quantity: 0.025
        max_quantity: 1.9
      order_book:
        levels: 17
        max_mutation_width: 8
      venue_behavior:
        latency_min: 10ms
        latency_max: 38ms
        transient_error: 0.0035
        disconnect_chance: 0.0008
        disconnect_for: 2400ms
  fake-microcap:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 500ms
      trade_interval: 420ms
      book_snapshot_interval: 2.5s
      instrument_refresh_interval: 35m
      kline_interval: 90s
      balance_update_interval: 6s
      price_model:
        drift: 0.0006
        volatility: 0.05
        shock_probability: 0.07
        shock_magnitude: 0.12
      trade_model:
        min_quantity: 0.2
        max_quantity: 4.0
      order_book:
        levels: 6
        max_mutation_width: 14
      venue_behavior:
        latency_min: 22ms
        latency_max: 110ms
        transient_error: 0.012
        disconnect_chance: 0.004
        disconnect_for: 8s
  fake-rangebound:
    exchange:
      name: fake
      enabled: true
      ticker_interval: 210ms
      trade_interval: 200ms
      book_snapshot_interval: 520ms
      instrument_refresh_interval: 22m
      kline_interval: 55s
      balance_update_interval: 3s
      price_model:
        drift: 0.00001
        volatility: 0.002
        shock_probability: 0.003
        shock_magnitude: 0.004
      trade_model:
        min_quantity: 0.06
        max_quantity: 1.1
      order_book:
        levels: 11
        max_mutation_width: 2
      venue_behavior:
        latency_min: 14ms
        latency_max: 36ms
        transient_error: 0.0012
        disconnect_chance: 0.0001
        disconnect_for: 3s

# eventbus: in-memory event bus sizing
eventbus:
  bufferSize: 25000
  fanoutWorkers: 8

# pools: object pool capacities
pools:
  eventSize: 25000
  orderRequestSize: 25000

risk:
  maxPositionSize: "1000"
  maxNotionalValue: "100000"
  notionalCurrency: "USDT"
  orderThrottle: 10
  orderBurst: 5
  maxConcurrentOrders: 10
  priceBandPercent: 1.25
  allowedOrderTypes:
    - Limit
    - Market
  killSwitchEnabled: true
  maxRiskBreaches: 3
  circuitBreaker:
    enabled: true
    threshold: 5
    cooldown: 2m

# apiServer: control API bind address (host:port or :port)
apiServer:
  addr: ":8880"

# telemetry: OTLP exporter configuration
telemetry:
  otlpEndpoint: http://capy.lan:4318
  serviceName: meltica-gateway
  otlpInsecure: true
  enableMetrics: true

# lambdaManifest: inline lambda definitions that will be materialised at startup
lambdaManifest:
  lambdas:
    - id: mm-btc
      providers:
        - fake-liquid
      symbol: BTC-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 28
        order_size: "0.05"
        max_open_orders: 3
      auto_start: true
    - id: grid-eth
      providers:
        - fake-volatile
      symbol: ETH-USDT
      strategy: grid
      config:
        dry_run: true
        grid_levels: 5
        grid_spacing: 0.75
        order_size: "0.4"
      auto_start: true
    - id: momentum-sol
      providers:
        - fake-volatile
      symbol: SOL-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 24
        momentum_threshold: 0.9
        order_size: "12"
        cooldown: "4s"
      auto_start: true
    - id: meanrev-xrp
      providers:
        - fake-calm
      symbol: XRP-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 30
        deviation_threshold: 0.7
        order_size: "2500"
      auto_start: true
    - id: logging-ada
      providers:
        - fake-liquid
      symbol: ADA-USDT
      strategy: logging
      config:
        dry_run: true
        logger_prefix: "[ADA-LOGGER] "
      auto_start: true
    - id: delay-doge
      providers:
        - fake-calm
      symbol: DOGE-USDT
      strategy: delay
      config:
        dry_run: true
        min_delay: "150ms"
        max_delay: "600ms"
      auto_start: true
    - id: noop-bnb
      providers:
        - fake-liquid
      symbol: BNB-USDT
      strategy: noop
      config:
        dry_run: true
      auto_start: true
    - id: mm-eth-tight
      providers:
        - fake-liquid
      symbol: ETH-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 18
        order_size: "0.08"
        max_open_orders: 2
      auto_start: true
    - id: grid-avax-wide
      providers:
        - fake-calm
      symbol: AVAX-USDT
      strategy: grid
      config:
        dry_run: true
        grid_levels: 7
        grid_spacing: 1.1
        order_size: "0.75"
        base_price: 38.5
      auto_start: true
    - id: momentum-doge-fast
      providers:
        - fake-volatile
      symbol: DOGE-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 12
        momentum_threshold: 0.35
        order_size: "3500"
        cooldown: "2s"
      auto_start: false
    - id: meanrev-btc-calm
      providers:
        - fake-calm
      symbol: BTC-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 45
        deviation_threshold: 0.55
        order_size: "0.02"
      auto_start: false
    - id: logging-portfolio
      providers:
        - fake-volatile
      symbol: ETH-USDT
      strategy: logging
      config:
        dry_run: true
        logger_prefix: "[VOLATILE-LOGGER] "
      auto_start: true
    - id: delay-dot-sweeper
      providers:
        - fake-liquid
      symbol: DOT-USDT
      strategy: delay
      config:
        dry_run: true
        min_delay: "100ms"
        max_delay: "400ms"
      auto_start: true
    - id: mm-avax-volatile
      providers:
        - fake-volatile
      symbol: AVAX-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 35
        order_size: "0.6"
        max_open_orders: 4
      auto_start: false
    - id: mm-sol-calm
      providers:
        - fake-calm
      symbol: SOL-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 42
        order_size: "1.5"
        max_open_orders: 1
      auto_start: false
    - id: grid-ltc-liquid
      providers:
        - fake-liquid
      symbol: LTC-USDT
      strategy: grid
      config:
        dry_run: true
        grid_levels: 6
        grid_spacing: 0.9
        order_size: "0.3"
      auto_start: true
    - id: momentum-bnb-liquid
      providers:
        - fake-liquid
      symbol: BNB-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 18
        momentum_threshold: 0.6
        order_size: "9"
        cooldown: "3s"
      auto_start: false
    - id: momentum-ada-calm
      providers:
        - fake-calm
      symbol: ADA-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 36
        momentum_threshold: 0.25
        order_size: "4200"
        cooldown: "6s"
      auto_start: true
    - id: meanrev-sol-liquid
      providers:
        - fake-liquid
      symbol: SOL-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 28
        deviation_threshold: 0.65
        order_size: "8"
      auto_start: false
    - id: meanrev-avax-volatile
      providers:
        - fake-volatile
      symbol: AVAX-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 32
        deviation_threshold: 0.8
        order_size: "0.9"
      auto_start: true
    - id: logging-calm-hub
      providers:
        - fake-calm
      symbol: BTC-USDT
      strategy: logging
      config:
        dry_run: true
        logger_prefix: "[CALM-LOGGER] "
      auto_start: true
    - id: delay-eth-volatile
      providers:
        - fake-volatile
      symbol: ETH-USDT
      strategy: delay
      config:
        dry_run: true
        min_delay: "80ms"
        max_delay: "320ms"
      auto_start: true
    - id: noop-avax-volatile
      providers:
        - fake-volatile
      symbol: AVAX-USDT
      strategy: noop
      config:
        dry_run: true
      auto_start: false
    - id: noop-ada-calm
      providers:
        - fake-calm
      symbol: ADA-USDT
      strategy: noop
      config:
        dry_run: true
      auto_start: false
    - id: mm-matic-ultra
      providers:
        - fake-ultra-low-latency
      symbol: MATIC-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 12
        order_size: "220"
        max_open_orders: 5
      auto_start: true
    - id: grid-btc-deep
      providers:
        - fake-deep-liquidity
      symbol: BTC-USDT
      strategy: grid
      config:
        dry_run: true
        grid_levels: 9
        grid_spacing: 0.55
        order_size: "0.03"
        base_price: 67350
      auto_start: false
    - id: momentum-uni-asia
      providers:
        - fake-asia-session
      symbol: UNI-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 30
        momentum_threshold: 0.42
        order_size: "650"
        cooldown: "1500ms"
      auto_start: true
    - id: meanrev-link-europe
      providers:
        - fake-europe-open
      symbol: LINK-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 35
        deviation_threshold: 0.6
        order_size: "520"
      auto_start: true
    - id: logging-night-audit
      providers:
        - fake-night-owl
      symbol: BTC-USDT
      strategy: logging
      config:
        dry_run: true
        logger_prefix: "[NIGHT-AUDIT] "
      auto_start: true
    - id: delay-microcap-retry
      providers:
        - fake-microcap
      symbol: PEPE-USDT
      strategy: delay
      config:
        dry_run: true
        min_delay: "200ms"
        max_delay: "900ms"
      auto_start: false
    - id: noop-rangebound-monitor
      providers:
        - fake-rangebound
      symbol: BCH-USDT
      strategy: noop
      config:
        dry_run: true
      auto_start: true
    - id: mm-noise-burst
      providers:
        - fake-noise-burst
      symbol: LTC-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 48
        order_size: "0.45"
        max_open_orders: 4
      auto_start: false
    - id: momentum-shib-ultra
      providers:
        - fake-ultra-low-latency
      symbol: SHIB-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 40
        momentum_threshold: 0.18
        order_size: "4800000"
        cooldown: "800ms"
      auto_start: true
    - id: grid-ton-swing
      providers:
        - fake-swing
      symbol: TON-USDT
      strategy: grid
      config:
        dry_run: true
        grid_levels: 8
        grid_spacing: 1.3
        order_size: "35"
        base_price: 6.1
      auto_start: false
    - id: meanrev-xlm-night
      providers:
        - fake-night-owl
      symbol: XLM-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 26
        deviation_threshold: 0.4
        order_size: "1800"
      auto_start: false
    - id: logging-fragile-monitor
      providers:
        - fake-fragile
      symbol: ETH-USDT
      strategy: logging
      config:
        dry_run: true
        logger_prefix: "[FRAGILE-WATCH] "
      auto_start: true
    - id: delay-europe-circuit
      providers:
        - fake-europe-open
      symbol: SOL-USDT
      strategy: delay
      config:
        dry_run: true
        min_delay: "120ms"
        max_delay: "520ms"
      auto_start: false
    - id: mm-asia-tight
      providers:
        - fake-asia-session
      symbol: XRP-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 22
        order_size: "3100"
        max_open_orders: 3
      auto_start: true
    - id: momentum-deep-breakout
      providers:
        - fake-deep-liquidity
      symbol: ETH-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 34
        momentum_threshold: 0.48
        order_size: "5.5"
        cooldown: "2500ms"
      auto_start: false
    - id: grid-microcap-ladder
      providers:
        - fake-microcap
      symbol: FLOKI-USDT
      strategy: grid
      config:
        dry_run: true
        grid_levels: 10
        grid_spacing: 1.9
        order_size: "150000"
        base_price: 0.00028
      auto_start: false
    - id: meanrev-rangebound
      providers:
        - fake-rangebound
      symbol: TRX-USDT
      strategy: meanreversion
      config:
        dry_run: true
        window_size: 60
        deviation_threshold: 0.2
        order_size: "15000"
      auto_start: true
    - id: momentum-fragile-break
      providers:
        - fake-fragile
      symbol: DOGE-USDT
      strategy: momentum
      config:
        dry_run: true
        lookback_period: 28
        momentum_threshold: 0.3
        order_size: "6200"
        cooldown: "5s"
      auto_start: false
    - id: mm-night-gold
      providers:
        - fake-night-owl
      symbol: XAU-USDT
      strategy: marketmaking
      config:
        dry_run: true
        spread_bps: 55
        order_size: "0.15"
        max_open_orders: 2
      auto_start: false
    - id: delay-noise-throttle
      providers:
        - fake-noise-burst
      symbol: ADA-USDT
      strategy: delay
      config:
        dry_run: true
        min_delay: "90ms"
        max_delay: "360ms"
      auto_start: true
    - id: logging-microcap-stream
      providers:
        - fake-microcap
      symbol: DOGE-USDT
      strategy: logging
      config:
        dry_run: true
        logger_prefix: "[MICROCAP] "
      auto_start: false
    - id: noop-ultra-hold
      providers:
        - fake-ultra-low-latency
      symbol: BTC-USDT
      strategy: noop
      config:
        dry_run: true
      auto_start: false
