@startuml
title Canonical Contracts (Class Diagram)

class CanonicalEvent {
  +event_id: String
  +provider: String
  +symbol: String
  +event_type: String
  +event_ts: Instant
  +ingest_ts: Instant
  +seq_provider: Long?
  +routing_version: Long
  +payload: Any
}

class ItemRef { 
  +ref_event_id: String
  +payload: Any 
}

class OrderRequest {
  +client_order_id: String
  +consumer_id: String
  +provider: String
  +symbol: String
  +side: TradeSide
  +order_type: OrderType
  +quantity: String
  +price: String?
  +tif: String
  +timestamp: Instant
}

class ExecReport {
  +provider: String
  +account: String
  +symbol: String
  +client_order_id: String
  +provider_order_id: String?
  +status: String
  +filled_qty: Decimal
  +remaining_qty: Decimal
  +avg_price: Decimal?
  +reason: String?
  +event_ts: Instant
  +ingest_ts: Instant
  +routing_version: Long
}

class ControlCommand {
  +message_id: String
  +consumer_id: String
  +type: String
  +payload: Any
  +timestamp: Instant
}

class CommandAck {
  +command_id: String
  +accepted: Boolean
  +reason: String?
}

class CommandResult {
  +message_id: String
  +consumer_id: String
  +success: Boolean
  +routing_version: Long
  +error_message: String?
  +result: Any?
  +timestamp: Instant
}

CanonicalEvent "1" o- "*" ItemRef : payload
@enduml
